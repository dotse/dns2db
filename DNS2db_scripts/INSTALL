### Installation instructions for DNS2db scripts ###
(c) iis.se, 2007

# These instructions assume that the dns2db and tcpdump binaries is
# already installed and in your $PATH.

# Overview of the collection and database creation process 

The process is started by the DNS2DB script and does the following:

First it mounts a 256MB ramdisk on /mnt/dns2db (for speeding up indexing 
of the database) and then tcpdump is started on the interface and writes 
data to a fifo. After this the tcpump-split binary reads from the fifo 
and writes to disk at specified intervalls.
At one minute intervalls dns2db reads the pcap file (if any) and creates 
a database file on ramdisk.
Sqlite3 is called to create indexes on the database file and at the same 
time, the pcap file is gzipped.
Finally the database file and the gzipped pcap file is moved to a 
directory structure from where the webserver can serve queries to the 
database files.

## Installation

Download the latest version of the scrips from:
http://opensource.iis.se/trac/dns2db/attachment/wiki/DownloadPage/DNS2db_scripts.tar

To do pcap file rotation we use tcpdump-split.
compile tcpdump-split.c with:
cc -lpcap tcpdump-split.c -o tcpdump-split


There are two files that need modification before running the scripts. 

First the DNS2DB script which is for starting and stopping the whole
process.

If on FreeBSD, no modifications should be necessary but check ramdisk
device and mountpoint.
If on Linux or other, check how ramdisk is created and modify to reflect 
your OS.

Second the tcpdump-split.example

Copy this file to tcpdump-split.sh and read the file.
It is well documented in it self and should not need explaining here.


## Starting and stopping the process

Start with:
./DNS2DB start tcpdump-split.sh

Stop with:
./DNS2DB stop


